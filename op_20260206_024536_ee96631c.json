{
  "author": {
    "email": "brunosmmm@gmail.com",
    "name": "Bruno Morais"
  },
  "data": {
    "branch": "master",
    "content": "# Phase 1 Critical Audit Fixes\n\n## Summary\nImplemented all Phase 1 critical fixes identified by the 10-agent comprehensive codebase audit.\n\n## Changes Made (15 files, 122 tests passing)\n\n### Security Fixes\n1. **eval() \u2192 safe_eval_math()**: Created `safe_eval_math()` in `hdltools/util.py` using AST-based restricted evaluator (only allows numbers + arithmetic). Applied in `abshdl/interface.py:77` and `mmap/builder.py:224`.\n2. **pickle.load() \u2192 restricted_pickle_load()**: Created `_RestrictedUnpickler` in `vcd/parser.py` that only allows safe builtin types. Applied in `vcd/parser.py` (CompiledVCDParser) and `tools/vcdevts/__init__.py`.\n\n### Correctness Fixes\n3. **vector.py:135 dumps() bug**: Changed `return repr(eval_scope)` \u2192 `return self.__repr__(eval_scope)`. Was returning repr of the scope dict instead of the vector string.\n4. **expr.py deprecated AST attrs**: Replaced `left.n`/`right.n` with `.value` at lines 543/550/555. Added `hasattr(ast, \"NameConstant\")` guard for Python 3.14 compat. Fixed `isinstance(right, ast.Mult)` \u2192 `isinstance(binop.op, ast.Mult)` bug in zero-check.\n5. **expr.py node.func.id crash**: Added `isinstance(node.func, ast.Name)` check before accessing `.id` in both `_evaluate()` and `_get_expr()`.\n\n### Error Handling\n6. **10 bare except clauses replaced**: concat.py, pattern.py, highlvl.py (\u00d72), builder.py, sim/__init__.py, verilog/codegen.py (\u00d72), vhdl/codegen.py (\u00d73). Each replaced with specific exception types.\n\n### Packaging\n7. **Removed broken setup.py**: Was inconsistent with pyproject.toml (7 vs 9 tools, wrong paths).\n8. **Migrated Poetry \u2192 uv**: Converted pyproject.toml to PEP 621 standard with hatchling build backend.\n9. **Pinned dictator dependency**: `master` \u2192 commit `b158aeec...`.\n10. **Fixed .gitignore**: Added `__pycache__/`, `*.egg-info/`, `build/`, `dist/`, `.pytest_cache/`.\n11. **Added .tx grammar package data**: Explicit force-include for 5 TextX grammar files.\n\n### Signal Assignment Type (No Change Needed)\nInvestigated the reported \"inverted assignment semantics\" \u2014 determined the behavior is actually correct (`reg`\u2192`<=` nonblocking, `var`\u2192`=` blocking). Only the naming convention is non-standard.\n\n## Test Results\n- 122 passed, 3 skipped, 0 failed\n- All existing tests continue to pass after all changes",
    "context": "Completed Phase 1 critical fixes from 10-agent comprehensive audit",
    "repository_id": "github.com/brunosmmm/hdltools",
    "session_id": 202602060126549947,
    "session_type": "Software Development",
    "title": "Phase 1 Critical Audit Fixes"
  },
  "entity_id": "20260206_0200_phase1-critical-audit-fixes",
  "lamport_clock": 42,
  "operation_id": "op_20260206_024536_ee96631c",
  "operation_type": "checkpoint_save",
  "parent_operation": null,
  "timestamp": "2026-02-06T02:00:16.437052+00:00"
}